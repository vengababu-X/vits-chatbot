<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PBR VITS Assistant</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:linear-gradient(-45deg,#003366,#004c99,#0066cc,#002244);
    background-size:400% 400%;
    animation:gradientMove 10s ease infinite;
}

@keyframes gradientMove{
    0%{background-position:0% 50%;}
    50%{background-position:100% 50%;}
    100%{background-position:0% 50%;}
}

#chat{
    width:400px;
    height:620px;
    background:rgba(255,255,255,0.15);
    backdrop-filter:blur(15px);
    border-radius:25px;
    box-shadow:0 20px 60px rgba(0,0,0,0.3);
    display:flex;
    flex-direction:column;
    overflow:hidden;
}

#header{
    padding:20px;
    text-align:center;
    color:white;
    font-weight:600;
    font-size:18px;
}

#messages{
    flex:1;
    padding:15px;
    overflow-y:auto;
    display:flex;
    flex-direction:column;
    gap:10px;
}

.msg{
    padding:10px 15px;
    border-radius:18px;
    max-width:75%;
    font-size:14px;
    line-height:1.4;
    animation:fadeIn 0.3s ease;
}

.user{
    background:#003366;
    color:white;
    align-self:flex-end;
    border-bottom-right-radius:5px;
}

.bot{
    background:white;
    color:#333;
    align-self:flex-start;
    border-bottom-left-radius:5px;
}

#inputArea{
    display:flex;
    padding:15px;
}

#input{
    flex:1;
    padding:12px 15px;
    border-radius:30px;
    border:none;
    outline:none;
    font-size:14px;
}

button{
    margin-left:10px;
    width:45px;
    height:45px;
    border-radius:50%;
    border:none;
    background:#003366;
    color:white;
    font-size:16px;
    cursor:pointer;
    transition:0.3s;
}

button:hover{
    transform:scale(1.1);
    background:#0055aa;
}

.typing{
    display:flex;
    align-items:center;
    gap:5px;
}

.dot{
    width:6px;
    height:6px;
    background:#999;
    border-radius:50%;
    animation:blink 1.4s infinite both;
}

.dot:nth-child(2){animation-delay:.2s;}
.dot:nth-child(3){animation-delay:.4s;}

@keyframes blink{
    0%{opacity:.2;}
    20%{opacity:1;}
    100%{opacity:.2;}
}

@keyframes fadeIn{
    from{opacity:0;transform:translateY(5px);}
    to{opacity:1;transform:translateY(0);}
}

</style>
</head>

<body>

<div id="chat">
<div id="header">PBR VITS Assistant</div>
<div id="messages"></div>

<div id="inputArea">
<input type="text" id="input" placeholder="Ask about PBR VITS..." onkeypress="if(event.key==='Enter') send()">
<button onclick="send()">âž¤</button>
</div>
</div>

<script>

let knowledge=[];

fetch("knowledge.json")
.then(res=>res.json())
.then(data=>knowledge=data);

function addMessage(text,type){
    const div=document.createElement("div");
    div.className="msg "+type;
    div.textContent=text;
    document.getElementById("messages").appendChild(div);
    document.getElementById("messages").scrollTop=9999;
}

function showTyping(){
    const div=document.createElement("div");
    div.className="msg bot typing";
    div.id="typing";
    div.innerHTML=`
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
    `;
    document.getElementById("messages").appendChild(div);
    document.getElementById("messages").scrollTop=9999;
}

function removeTyping(){
    const t=document.getElementById("typing");
    if(t) t.remove();
}

function send(){
    const input=document.getElementById("input");
    const originalText=input.value.trim();
    const userText=originalText.toLowerCase();

    if(!userText) return;

    addMessage(originalText,"user");
    input.value="";

    showTyping();

    setTimeout(()=>{

        removeTyping();

        let bestMatch=null;
        let highestScore=0;
        const words=userText.split(/\s+/);

        for(let item of knowledge){

            let score=0;

            for(let key of item.keywords){

                const keyLower=key.toLowerCase();

                if(userText===keyLower){
                    score+=10;
                }

                if(userText.includes(keyLower)){
                    score+=5;
                }

                for(let word of words){
                    if(word.length>2 && keyLower.includes(word)){
                        score+=2;
                    }
                }
            }

            if(score>highestScore){
                highestScore=score;
                bestMatch=item.text;
            }
        }

        if(!bestMatch){
            bestMatch="Sorry, I could not find specific information. Please visit https://pbrvits.ac.in/ for complete details.";
        }

        addMessage(bestMatch,"bot");

    },900+Math.random()*500);
}

addMessage("Hello! I am the PBR VITS Chatbot. How can I help you today?","bot");

</script>

</body>
</html>
